---
title: "Hypothesis testing tutorial: Are toads right-handed?"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
library(here)
library(kableExtra)

load(here::here("inst/tutorials/toad_spreadsheet/toad_as_character.RData"))

#getFromNamespace(here::here("data/toad_as_character.RData")) #should work regardless

#data("toad_as_character", 
#     package = "abdcompanion") #this would load from installed packaged
#                              #only will work if packaged installed


# footnotes to appear at bottom of main windw
footnotes <- c(
"Notes: notes on each row", 
"n: sample size; the total number of toads, coin flips etc",
"X.R.hand: Right-handed; the number of right-handers observed in a sample.  This study observed 14 righties.",
"prop.x: proportion X; the number of right-handed toads (X) out of all of them (n)",
"prob.x: probability X: is the probability that, if our null is correct, how likely are we to end up with a sample of 14 right handers out of 18 due to chance.")

# bootstrap options for tables (?)
my.boot.opt <- c("striped", 
                 "hover", 
                 #"condensed",
                 "responsive")
```


## Suggestions

* If you follow any links to webpages I recommend right clicking to open up a new tab in your browser.
* You can zoom in and out of your web browser to adjust the size of the text and tables.  This is usually done by holding the "Control" or "Command" and then "+" or "-" to zoom in or out.
* be sure to hit the "Retry button" to try a question
* Note that the R functionality is limited; remember to hit the "Run code" icon
* be sure to scroll down to check out a table in its entirety

## To Do

* worksheet as pdf
* plots (barplots)?
* when/how should I disucss NHST?
* add quiz question about "what is the Ho"
* Datafamed had good segement in binomial data


## Preface

This tutorial is based on Chapter 6, "Hypothesis testing"" from Whitlock & Schluter's [*Analysis of Biological Data*.](http://whitlockschluter.zoology.ubc.ca/)

In section 6.2: "Hypothesis testing: an example" (pg 153, 2nd ed), Whitlock & Schluter present data from a paper by Bisazza et al (1996) titled ["Right-pawedness in toads"](https://www.nature.com/articles/379408a0), published in Nature.

Whitlock and Schluter's main goal is introduce the general workflow of **hypothesis testing**, using **binomial data** on toad "pawedness" as an example.  This tutorial follows the general outline of the chapter, but will go a bit deeper into some of the math behind what they are doing by walking your through the intermediate steps behind their calculations and providing broader context for what they are doing.

```{r eval=FALSE, include=FALSE}
# this code should go in main body but doesn't work
#![Common toad](images/toad.jpg)
```




#### References

Bisazza, A, C Cantalupo, A Robins, LJ Rogers and G Vallortigara.  1996.  [Right-pawedness in toads.  Nature 379: 408.](https://www.nature.com/articles/379408a0)

Fitch & Braccini 2013.  [Primate laterality and the biology and evolution of human
handedness: a review and synthesis.  Annal of the New York Academy of Sciences.](https://nyaspubs.onlinelibrary.wiley.com/doi/abs/10.1111/nyas.12071)

Whitlock, M and D. Schulter.  2014.  Analysis of Biological Data.  Freeman. [Book website.](http://whitlockschluter.zoology.ubc.ca/) Available on [Amazon](https://www.amazon.com/Analysis-Biological-Data-Michael-Whitlock/dp/1936221489/ref=sr_1_1?ie=UTF8&qid=1533844028&sr=8-1&keywords=analysis+of+biological+data)



## Introduction: Handedness in Humans

Most humans preferentially carry out tasks with a single hand.  The data used in this tutorial and in Whitlock and Schulter (2014) came from a study that ask: Do other species preferentially complete tasks with one hand (or paw)? 

```{r human.hands}
question("Most humans are right handed.  What proportion of the population do you think is right handed?",
    answer("0.5"),
    answer("0.75"),
    answer("0.90", 
     correct = TRUE,
     message = "Typically the proportion of a population which is right handed is 0.90 (= 90%)"),
    answer("0.99"),
    allow_retry = TRUE
  )
```


## Introduction: handedness in toads?

Humans populations are typically about 90% right-handed (Fitch & Braccini 2013).   As part of a study on amphibians, Bisazza et al (1996) assayed 18 wild-caught [common toads (*Bufo bufo*)](https://en.wikipedia.org/wiki/Common_toad) in the lab to determine whether they completed a task preferentially with their right or left paws.  (Common toads range throughout Europe, Russia and North Africa; if you are looking for a dissertation topic I do not think geographic variation in pawedness has been explored yet).

In this particular study, 14 of the 18 toads completed the task with their right paw, and 4 completed it with their left.  So, most of the toads appeared to be "right pawedes."  Is this evidence that toads in this population are like humans and predominantly use one paw over the other?  How strong is this evidence? 


```{r assumption}
question("Pop quiz: what is one relevant assumption we will have to make about these toads brought in to the lab in order for our statistical calculations to be correct?",
    answer("They are indeed toads and not frogs.",
           message = "The number of times I have typed frogs instead of toads...  Is this a realistic assumption?"),
    answer("They were randomly sampled from the population", 
           correct = TRUE,
           message = "This is a ubiquitous statistical assumption.  But how would it actually be achieved when sampling toads? ..."),
    answer("Toads care about math"),
    answer("42",
           message = "Normally correct, but not in this case."),
    allow_retry = TRUE
  )
```



## Overview of tutorial

In this tutorial we will walk through Whitlock & Schluter's assessment of the question of toad handedness and carry out a formal **hypothesis test** to address this question.  We will work through the calculations needed to reproduce Table 6.2-1 (page 156) and the other calculations in the text (pages 153-159), as well as dig a bit deeper into the underlying math.  We can do all of these calculations in Excel or another spreadsheet.

In particular, we will walk through the process of carrying out a **hypothesis test** using what statisticians call **binomial data**.  We will do this by calculating a **p-value** and comparing it against a something known as a **sampling distribution.**  Sampling distributions are a very challenging concept in statistics, and sometimes they are skipped altogether.  Working with binomial data, however, makes it a bit easier to see how they work.  

In their book, Whitlock & Shulter only touch briefly upon sampling distributions with their toad example, though they had discussed them in detail earlier in chapter 4, "Estimation", where they discussed the relationship between sampling distributions and the **standard error (SE)**.


## Caveat: The hypothesis we are focused on

When we talk about **statistical hypothesis testing** we usually state things in terms of a **null hypothesis (Ho)** and an **alternative hypothesis (Ha)**.  Unfortunately it can be easy to get mixed up about what the statistical hypothesis is. 

The specific hypothesis being tested is *not* whether toads are predominantly right-handed or left-handed; rather, whether there is an overall tendency in the population to favor one hand, which could be right handed or left handed.  

Stated another way, we are focused on the question "Are toads **un**-biased" in their paw preference?"  The **null hypothesis (Ho)** is therefore "there is no bias in handedness."  So the proportion of right-handed toads should be the same as left-handed toads (1:1, 50:50, etc).  (Similarly, toads could be ambidextrous and they use a random paw each time they face a task). 

If toads *are* biased, they could be either biased to being right-pawed OR biased towards being left-pawed.  The right or left question is dealt later though.  The **alternative hypothesis (Ha)** therefore encompasses both options.  This is somewhat awkward, but the reason things are framed this way should gradually become apparent. 

One way thinking about this is to imagine I hadn't told you about the data from the experiment yet but had just ask you "do you think toads are 'handed' like humans?" and not gotten into the specifics for right or left handed yet.

(If you remember earlier stats classes you might recall the difference between **2-tailed** and **1-tailed tests**.  We'll talk about this later.)


## Hypothesis testing with binomial data

Before getting into the specific calculations let's topic about the *type* of data we are working with.  We'll step away from amphibians for a second and think about something for familiar: **coin flipping.**

When you [flip a coin](https://en.wikipedia.org/wiki/Coin_flipping) you get one of two possible results: 

* "heads" (usually the face of a famous person), or 
* "tails" (An animal?  A monument?)  

Statisticians call the process of flipping the coin a **trial**.  In particular they usually call it a **binomial trial** or a [**Bernouli trial**](https://en.wikipedia.org/wiki/Bernoulli_trial), named after the 15th century mathematician [**Jacob Bernouli**](https://en.wikipedia.org/wiki/Jacob_Bernoulli).   

If you do several coin flips you have generate data which can give you information on how likely you are to get heads or tails.  This is called **binomial data**.  The number of heads you get is the number of **events** or **successes**.


## The toad data are binomial data

The toad data from Bisazza et al (1996) is also **binomial data**.  It consists of 18 **trials** where there are two possible results: left paw or right paw.

**Binomial data** are very common in biology: 

* Survival: Is an organism alive or dead?  
* Reproduction: Is a fruit fly "virgin" or not?
* Species interactions: Was a flower eaten or not eaten?  
* Disease: Is a patient infected with a virus or not?  

Binomial data is also very useful for demonstrating core concepts of hypothesis testing because the math is fairly easy.



```{r binom.dat}
question("Which one of the following do you think is a type of **binomial data** that could be collected on fruit flies?",
    answer("The length of fruit fly wings",
    message = "This would be a type of continous numeric data"),
    answer("The color of fruit fly eyes", 
           message = "Fruit fly eyes can be many different colors, not just two.  This would be categorical data."),
    answer("Fruit fly sex (XY male or XX female)", 
           correct = TRUE,
           message = "When there are two possibilities the data can be binomial"),
    answer("The number of eggs laid by a female fruit fly",
           message = "Fruit flies can lay many eggs; this would be a type of count data."),
    allow_retry = TRUE
  )
```


## Carrying out calculations in a spreadsheet 

The goal of this tutorial is to walk you step by step through the calculations done by Whitlock & Schluter and to provide opportunities to interact directly with the data.  Ideally, while working through this tutorial you will carry out the calculations as you go either on the provided worksheet or in a spreadsheet.  A spreadsheet-like table will be displayed showing you the calculations as they are done.  (You can also do calculations using basic R code within the tutorial if you want.)

There will also be prompts to answer questions on the calculations and concepts as you go.  


## Learning objectives

By the end this tutorial you should be familiar with these concepts and any related calculations

* Hypothesis 
* Null hypothesis (Ho)
* Alternative hypothesis (Ha)
* Sampling distribution
* test statistic
* binomial data
* critical value (alpha)
* binomial distribution


## Summary of the toad-handedness data

The table below summarizes the data we will be using and the abbreviations that will be used in subsequent tables.  Note the following naming conventions:

* The letter **X** is often used to indicate the number of focal **events** or **successes**, so I call the number of right-pawed (or handed)  toads **X.right.handed**.  
* The letter **n** indicates sample size which here is the total number of **trials**; that is, the total number of toads in the study.  I'll call this **n.total** for emphasis.

In the subsequent steps of this tutorial we'll reformat these numbers into a particular structure that will represent what is known as a **sampling distribution**.  This will allow us to calculate the **p-value**, which will allow us to assess the hypothesis of whether toads preferentially use one paw or not.

```{r echo = F}
x <- sheets.list[[1]][c(1:4),c(1:3)]
x %>%
  knitr::kable(caption = "Raw toad handedness data") %>%
  kableExtra::kable_styling(bootstrap_options = my.boot.opt,
                position = "left")
```



## Data exploration worksheet

In a spreadsheet set up a table that looks like the one below, or use the provided blank handout.  An example of spreadsheet can be downloaded as a .xlsx file from [here](https://github.com/brouwern/abdcompanion/raw/master/inst/tutorials/frogs_spreadsheet/toad_hypothesis_test_XLSX.xlsx). [link broken]

We'll start by focusing on the data which were collected: of 18 toads ("n" in column B), 14 were right handed ("X.R.hand", in column C) and 4 were left handed ("L.hand", column D).  We'll first fill out the "prop.X" (with a "p") and "prob.X" (with a "b") columns for the row with X.R.hand = 14.  Then we'll fill out the rest of the table.

```{r echo= F}
sheets.list[[2]] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) %>%
  footnote(alphabet = footnotes)
```


```{r prop.x}
question("What do you think the prop.X column stands for ",
    answer("Proportion X, the proportion of toads that were right handed for a given sample.",
           correct = TRUE),
    answer("Probability of X, the probability that the toads were right handed.", 
          message = "prob.x with a b stands for probability"),
    allow_retry = TRUE
  )
```





## Structure of the data exploration worksheet

There's a lot going on here, but the structure of the table will hopefully become apparent as we work through things.  We will be building up the whole table to explore the implications of the **null hypothesis (Ho)** that toads are no more likely to be right handed than left handed.  

The columns we're starting working with are these: 

* The "n" column is the starting number of toads (the sample size). 
* The "X.R.hand" column is an abbreviation of "right-handed" and is the number of right-handers observed in this sample.  We'll start with what was observed, but then work through other ways the experiment could have theoretically played out
* "prop.X" is the proportion ("prop") of toads that are right handed.  

**prop.X** is calculated as:  (number observed R-handed)/(total observed).  Again, we'll start with what as observed and then calculate out what else could have happened

We'll get to the columns (prob.x, tail.prob etc) later.


```{r echo= F}
sheets.list[[2]] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```


## What is the observed proportion (prop.X) of toads that are right handed? 

Some mental math practice: 14 toads were right-handed out of 18.  What is the approximate proportion of right-handed toads?

```{r q1}
question("Estimate the approximate value of prop.X, the observe proportion of right-handed toads",
    answer("0.25"),
    answer("0.5"),
    answer("0.75", correct = TRUE),
    answer("0.99"),
    allow_retry = TRUE
  )
```

## Calculating observed proportion (prop.X) of toads that are right handed

Throughout the tutorial there will be calculator windows that will allow you to do these computations using basic R code.  We can calculate the proportion of right handers using the code "14/18".  

**Click the blue "Run" icon to the right to calculate the precise result.** (It won't work if you just press enter like in a real R sessions)

(In a spreadsheet you'd type "=14/18")

```{r div, exercise=TRUE}
14/18
```


## Proportion of a specific number of right-handers

What have we just calculated?  14/18 = 0.78.  So ~78% of the toads in the sample were right handed.  This is filled in as a **proportion** now in the **prop.X column** (Column E).


```{r echo= F}
sheets.list[[3]] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```

## From proportion to probability

We've just calculated something empirically based: the **proportion** of right-handed toads we actually saw.  Now consider something theoretical and more abstract: 

>Imagine that in reality when a toad is born it is no more likely to be right handed than left handed.  That is, there is a 50% chance a toad will be right handed, and a 50% chance it will be left handed.  (Equivalently, the proportion of right-handers in the population is 0.5 and the proportion of left handers is 0.5.)  This alternative reality has a special name: this is our **null hypothesis.** What if you collected 18 toads in this hypothetical reality and did a study of paw preference, and 14 of them used their right paw in your study.  How likely is it that in a world where the proportion of right-handed toads is truly 0.5 that you just happened to get 14 that were right handers?  Is this impossible? Unlikely?  Probably?  Inevitable?

Stated more formally

>If the null hypothesis (Ho) was true, what is the probability that we'd get the data we happened to get?

## Probability of a specific number of right-handed toads

We'll represent the **probability** of getting 14 right-handed toads in a world where toads are 50:50 right:left as **"prob.X"**, or the probability of getting X.

More formally "prob.X" is the probability that, if our null (Ho) is correct, we will end up with a sample of 14 right handers out of 18 just due to chance.

One more time, for emphasis: if the population overall has a 50:50 ratio of right:left handed toads, how likely are we to end up getting an apparently biased sample of 14 right handers and only 4 left handers?

The math to calculate this isn't hard, but isn't intuitive necessarily either.  Before we take on the numbers we'll develop some intuition about **binomial data**.


## Aside: thinking about coin flipping

Let's step away from toads for a second and go back to statisticians favorite pass time: coin flipping.  

Consider the following two questions.
```{r q2.1}
quiz(
question("What do you think is the probability of getting, 
         say, 14 heads if you flip a coin 18 times?",
    answer("almost 1 (you will definitely get it)"),
    answer("1 in 10 (probablity of 0.1)", message = "Too optimistic"),
    answer("1 in 100", correct = TRUE),
    answer("1 in 10,000", message = "Too conservative"),
    answer("1 in 1,000,000"),
    allow_retry = TRUE
  )
)
```

(For what its worth, I can never remember the order of magnitude of this question and have to guess).


## Simulating 18 coin flipes

We can use R to **simulate** this **thought experiment** using some code.  If you run the following code R will  carry out a single experiment (n = 1) where 18 binomial trials are conducted (size = 18) where the probability of an event occurring is 50:50 (prob = 0.5).  

So, R will digitally flip 18 coins for us each time we click "Run".  The number that gets displayed is the number of heads.  You can keep running th code to see if you get the magic number 14.  

```{r rbinom1 , exercise=TRUE}
#number of "heads" out of 18 flips
rbinom(n = 1, size = 18, prob = 0.5)
```

**Optional**: If you are curious, you can change the R code to other numbers.  What does prob = 0.5 represent?  What does n = 1?  Size = 18?  How would you set up a single coin flip?

## Aide: LOTS of coin flipping

Ok, so that's if you flipped a coin 18 times (or have 18 coins and flip them all at the same time).  Its not very likely to get 14 if you only do this once.  Now let's scale things up and simulate LOTS of coin flippers.

```{r  q2.2}
quiz(

question("If **100 people** in your class all flipped 18 coins *each*, what is the probability that **at least one person** will get 14 heads?",
         
    answer("almost 1 (someone will probably get lucky and get 14 heads)",
           message = "Recall that the probablity of getting 14 heads was about 1 in 100.  So 1/100 * 100 = 1.",
           correct = TRUE),
    
    answer("about 1 in 10 (probablity of 0.1)",
           message = "Recall that the probablity of getting 14 heads was about 1 in 100.  So 1/100 * 100 = 1."),
    
    answer("about 1 in 100",
           message = "Recall that the probablity of getting 14 heads was about 1 in 100.  So 1/100 * 100 = 1."),
    answer("about 1 in 10,000",
           message = "Recall that the probablity of getting 14 heads was about 1 in 100.  So 1/100 * 100 = 1."),
    
    answer("about 1 in 10,000,000",
           message = "Recall that the probablity of getting 14 heads was about 1 in 100.  So 1/100 * 100 = 1."),
    allow_retry = TRUE
  )

)
```


## Simulating LOTS of coin flips

We can simulate this by changing "**n = 1**" to "n = 100".  (This is because the "experiment" is to flip a coin 18 times; we originally did n=1 set of flips.  Now we'll do N=100 sets of 18 flips).

Look across the R output. Each number represents a student in our hypothetical class and the number of heads they got. Do you see a 14?

(don't work about the details of this code, just click "run"; keep clicking it if you want)
```{r , rbinom100, exercise=TRUE}
rbinom(n = 100, size = 18, prob = 0.5)
```

## Visualizing LOTS of coin flips

A [**histogram**](https://en.wikipedia.org/wiki/Histogram) is a convenient way to visualize this simulation.  The following code will plot the data from the simulation.  

* The x-axis is the number of "heads" observed out of 18 
* The height of the bar is the number of students in our class of 100 that got a certain number of heads.  (So, the y-axis represents students, not coins)
* The red line is at 14; if part of the graph is to the right of the line, at least 1 student got 14 heads.


(again, don't worry about the code)
```{r , hist, exercise=TRUE}
#create some random data
x <- rbinom(n = 100, size = 18, prob = 0.5)

#plot it
hist(x, xlim = c(0,18), 
     xlab = "Number of heads", 
     ylab = "Number of students",
     main = "Simulating 100 coin flips")

#add a reference line
abline(v = 14, col = 2, lwd =3)
```



## Back to toads: 

We can calculate the precise theoretical probability of getting 14 heads out of 18 flips.  To calculate this  we need the **binomial distribution.**  I was just using a special R function **rbinom()**, which stands for "random binomial".  

For this tutorial, however,  I'll walk through how these probability calculations can be done in mostly Excel or a similar spreadsheet using the **BINOM.DIST()** function, which works a little differently than **rbinom**.  We'll use the binomial distribution to calculate exactly what the probability is of 14 of 18 toads being right handed, IF the real probability was 0.5.  (Remember that: we are doing these calculations assuming the null hypothesis is true)

## Binomial probabilities in Excel

The binomial distribution for a given scenario is calculated in Excel using the **BINOM.DIST()** command.  This stands for "Binomial distribution."  The code is shown in the appropriate place in the table below.		

The arguments of the **BINOM.DIST()** function are:

* number_s: the number of "successes" (hence "_s") or "events"; what we are calling "X"
* trials:	the number of opportunities for a "success" to occur; here 18 toads
* probability_s:	the null hypothesis (Ho) about the probability of the success occurring; here, 0.5 (same as 1:1, 50:50 or 50%)
* cumulative:	this is set to "FALSE" so we get the estimated probability of the specific event and only that event; otherwise we are calculating a value related to our event of interest (14 right handers) plus some other things.

If you were to type the number directly into the function you'd enter  "=BINOM.DIST(14, 18, 0.5, FALSE)".  You can make it more general, though, by entering in the coordinates where those numbers appear in the spreadsheet.

The code shown in the spreadsheet mock-up below assumes that the "X.R.hand" column is your column C, and the "n" column is your column B.  So cell C16 = 14, and cell B16 = 18.

```{r echo= F}
sheets.list[[4]][,-c(8:9)] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```









## Probability of a specific number of right-handed toads

Excel's **BINOM.TEST()** function tells us that probability of 14 toads being right handed in the null hypothesis was true is about **0.012** (in column F, "Prob.X").  Note that this is the **probability** of getting **exactly 14 toads**; so this is the probability of getting the observed number of right-paweded toads as in the study, but making the assumption that toads are not biased to be right or left handed.  

So, we can say that if toads are not more likely to be right handed than left handed (because why would they?), we would expect that the probability of getting  a sample of *exactly* 14 right-handed toads (0.78 right handed, or 78%, the value in the "prop.X" column) is 0.012.  So pretty unlikely.  Not impossible, but not what you'd expect.  

Another way of saying this is that if we got that many right-handed, we would be surprised (again, assuming that the real probability is indeed 0.5), because the probability is fairly small:  A proportion of 0.012 is equivalent to about 1/100 (1/112 to be more precise).

Similarly, if you wanted to place a bet, it wouldn't seem dumb to bet that there wouldn't be 14 right handed frogs if you knew ahead of time that there was a 50:50 chance that frogs were righties.

To use the coin flipping example, and extend it a bit:  This is analogous to flipping a brand new coin that you just got from the bank 18 times and getting 14 heads.   Our calculations indicate that you would have about a 1 in 100 chance of getting exactly 14 heads.  

But.... if 100 people did this, then there's  a pretty good chance one of them will get it; that is 1/100*100 = 1

```{r echo= F}
sheets.list[[5]][,-c(8:9)]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) # %>%
  #footnote(alphabet = footnotes)
```




## Filling out more of our data table

All we've done so far is focus on our *observed* data.  Key to doing statistics, however, is thinking very explicitly about other ways the experiment could play out if we did the exact same experiment again (or, equivalently, in parallel universes outside our own).  This is one reason why stats people are so fond of flipping coins: easy to repeat, and each repetition is going to obey the same laws of physics as the previous one.  This is in contrast to real science, where exactly replicating an experiment is very difficult, if not impossible.

In the next steps, we will explicitly work through **all** of the other ways the results could have played out.  Each row of our table will represent one way this study of 18 toads could've played out, and we'll calculate the probability of the result IF the null hypothesis (Ho) was true that toads are 50:50 right:left handed.

## Filling out more of our data table

So, to explore other ways the experiment could've played let's fill out the table some more.  Hopefully the way I've structured things here will become apparent as we work through this.  

We'll start with something really easy: putting the same size (number of trials) in the **n** column.  n is **always 18** because we are only considering a study where 18 toads were examined.  


```{r echo= F}
sheets.list[[6]][,-c(8:9)]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive"))
```




## Fill out data table some more

* The goal of this table is to think about all the possible ways the study could've panned out and all the possible alternative sets of results we could've gotten.
* That is, if you sample 18 toads, what are the other possible number of right-handed toad 
 you could've observed?
* This is just simply all the other possible number of right handed toads: 0 right handers
 or 1 right hander, or 2, or 3, ... or ... 18.
* So let's fill out the "X.R.hand" column with all of these possibilities, from 0 at the top through 14 our observed data to 18, the maximum number of right handed toads we could've possibly observed.


```{r echo= F}
sheets.list[[7]][,-c(8:9)]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```






## What is our null hypothesis (Ho)?

Now let's directly consider the **null hypothesis (Ho)**:

So, which row of the data table matches up to our **null hypothesis**?  Again, only 1 row matches our real data (14 right handers) and the rest of the rows are to help us think about other ways the experiment could've panned out.  One row precisely represents our null hypothesis.  Which one is it?



```{r echo= F}
sheets.list[[8]][,-c(8,9)]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive"))
```


```{r q4}
question("Assume that toads are no more likely to be right-handed than left-handed.  You'd therefore expect that if you collected 18 toads how many would be right handed?",
    answer("3"),
    answer("6"),
    answer("9", 
           correct = TRUE),
    answer("12"),
    answer("16"),
    allow_retry = TRUE
  )
```



## What is the probability of exactly 9 right-handed toads 

If toad are no more likely to be right handed than left handed, you'd probably expect that if you collected 18 toads, 9 would be right handed, and 9 would be left handed.  If this is how the experiment played out 50% would be righties. We can fill in 0.5 in the **prop.X** column (Column E).

While we might *expect* to get 9 toads that are right handed if the null was true, how *likely* is it to actually get 9 toads?  That is what is the **probability** of 9 toads (The **prob.X** w/ a **"b"**, not a "p").



```{r echo= F}
sheets.list[[9]][,-c(8,9)] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```


## Getting exactly 9 toads

We'll calculate the **probability** of getting nine toads exactly with a tool called the **binomial distribution** in a second.  First, though consider what it might be approximately.
```{r q5}
question("What is the approximate **probability** that you would get **exactly 9** right handers in the study? (equivalently, if you flipped 18 coins, you'd get exactly 9 heads?)",
    answer("1 in 1000; pretty unlikely",
           message = "Its unlikely, but not that unlikely!"),
    answer("2 in 10 (= 1 in 5)",
           correct = TRUE,
           message = "Good intuition.  To get exactly 9 would be kind of unlikely, at least no more likely than rolling a 6 on a 6-sided dice.  
           As we'll get to next, getting around 9 (say, between 7 and 11, is fairly unlikley)."),
    answer("5 in 10 (= 1 in 2, or 50:50)", 
           message = "This is a common intuition but incorrect.  Getting around getting around 9 (between 7 and all, say) is close to 50:50, but getting exactly 9 is unlikely."),
    answer("1; defintely"),
    allow_retry = TRUE
  )
```

## What is the probability of exactly 9 right-handed toads?

What's the probability of getting exactly 9 right handed toads if the null hypothesis is true?  The answer might be a bit surprising: **~0.185.**  Why isn't it 0.5?

Remember, we are considering the probability of getting **exactly** 9 right-handed toads. (AND we are thinking about a world where the true probability of toads being righted handed is indeed 0.5).  Getting 8 toads doesn't count, neither does 10.  We want exactly 9.

We can fill this value in to our table under "prob.X" in the far-right column.  In Excel this could be done by modifying the BINOM.DIST() code we used previously.  If you copy and paste that code into the appropriate cell it should update to show the correct answer.  Otherwise, it should be something like "=BINOM.DIST(C11,B11,0.5,FALSE)".  

```{r echo= F}
sheets.list[[10]][,-c(8,9)] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```






## Why isn't the answer 0.5?

* Its not 0.5 because we are asking "What are the chances of getting **exactly 9** toads which are right handed, no more no less." 
* This is like asking "What are the chance of flipping a coin 18 times and getting exactly 9 heads."
* A fair coin has a 50:50 chance of being heads, but chances are if you flip one 18 times you won't get exactly 9 heads.
* You will probably get close to 9; maybe 9 exactly, but also maybe a few more (10 or 11), or a few less (7 or 8).
* So, overall, its very likely that you'll get close to 9 heads, but exactly 9 is kind of hard.



```{r echo= F}
sheets.list[[11]][,-c(8,9)] %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```








## What is the probability of getting ~9 toads?

* Its pretty unlikely to get exactly 9 right handed toads.  What about getting around 9 toads, eg, between 7 and 11?
* We can explore this by 
  + calculating the probabilities of all of these different options and
  + adding them up
* First we can calculate **prob.X** for 7, 8, 10 and 11 right handers.
* Next we can add these probabilities up.  We'll put the sum of these values in the "**total.prob**" column on the far right side of the table ("total probability"; column H). 
* So, we can add up 0.12 + 0.17 + 0.19 + 0.17 + 0.12, which = ~0.77
* This indicates that while getting exactly 9 right handers is not a given, getting about 9 will frequently happen.

```{r echo= F}
sheets.list[[12]][11,"H"] <- round(as.numeric(sheets.list[[12]][11,"H"]),3)
sheets.list[[12]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```







## What is the probablity of an extreme event?

* What about something extreme, like flipping a coin 18 times and getting all heads...
* ...or, for this study, sampling 18 toads and all of them are right handed even though in the population they are from the ratio of righties to lefties is 50:50?
* We can fill in the cell for the "proportion.X" column as 1 (18/18 = 1).  
* Now, What is the probability of this occurring ("prob.X")?

```{r echo= F}
sheets.list[[13]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```


## What is the probablity of an extreme event?

```{r q14}
question("What is the probability of all 18 toads being right handed if the null is true?",
    answer("0.0; never going to happen ever",
           message = "Its not likely, but it could potentially happen"),
    answer("1 in 100,000; very very unlikley", 
           correct = TRUE,
           message = "That's right; this is almost never going to happen.  Not impossible, but not a bet most people would make."),
    answer("1 in 100",
           message = "Less likely than this..."),
    answer("1 in 10",
           message = "MUCH less likely that this!"),
    allow_retry = TRUE
  )
```







## Writing out really really really small probabilities

This probability can be calculated using the **BINOM.TEST()** function again. 

As you might expect, the probability of this happening is really really really really really small:

* A spreadsheet will usually state this in scientific notation: 3.81E-06
* which means 3.81*10^-6
* or 0.00000381
* or about 4 in 1 million
* or 1 in 250,000

However, since this number is so small, it will often be rounded to zero, as happens here since I'm rounding to 3 digits.

Think about how small this number is: this means that if every student on campus right now stopped, pulled out a coin, and flipped it 18 times, not a single one will likely get 18 heads.

```{r echo= F}
sheets.list[[14]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```








## What is the probablity of a slightly less extreme event?


What about just 17 right handers and only 1 leftie? This is just a touch more likely: 6.87E-05 or 6.87 * 10^-5 or 0.0000687.  Its so small, though, it basically is still rounded to zero.

```{r echo= F}
sheets.list[[15]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```








## What about an extreme number of left handed toads?

How about the opposite scenario: flipping a coin 18 time and getting no heads? (or, for us, sampling 18 toads and getting all lefties when
the source population is 50:50).

We can fill in 0 for our **prop.X** in column E for our proportion of right-handers.  What's the *probability* of getting 0 righties and all lefties?


```{r echo= F}
sheets.list[[16]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```


## What about an extreme number of -left- handed toads?

```{r alllefties}
question("What is the probability of all 18 toads being LEFT handed if the null is true?",
    answer("0.000; never going to happen ever",
           message = "Its not likely, but it could potentially happen"),
    answer("0.0000687", 
           correct = TRUE,
           message = "That's right; Same as for getting all righties"),
    answer("1 in 100",
           message = "Less likely than this..."),
    answer("1 in 10",
           message = "MUCH less likely that this!"),
    allow_retry = TRUE
  )
```









## What about an extreme number of -left- handed toads?

* The probability is 3.81E-06, the same as for 18 head and no tails.   
* This is because the converse of getting 18 heads and no tails is getting 18 tails and no heads.
* Or, for this study, the converse of getting 18 right handers and no lefties is getting 18 lefties and no righties
* Use BINOM.TEST() to calculate this in Excel (the easiest way to do it would be to just copy and paste one of your previously used formulas)
* Again, this number is printed out as "0.000" because I am rounding to 3 digits; but it is not actually 0.000!


```{r echo= F}
sheets.list[[17]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```






## Filling out some more parts of the table


For the sake of completeness we'll fill in a few more situations.  First, getting just 1 right hander and  17 lefties is the converse of getting 18 right handers and just 1 leftie.  Again, very small, but not exactly 0.000, it just gets rounded to that to save space.
 
```{r echo= F}
sheets.list[[18]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```




## What is the opposite of 14 right-handed toads?

One last preliminary number.  We observed 14 right handers and only 4 lefties.
Something to consider is what if we got the converse of this: only 4 righties and 14 lefties?  Both possibilities have the same probability.  

Moving forward, it will be important to consider both what we happened to observe and the converse or mirror image event.

When thinking about whether toads might be right or left handed, we are likely biased by the fact that humans are predominantly right handed.  But before we did the experiment, we might not have an expectation of whether, if a bias exists, its towards right-handedness or left-handedness.  We therefore should consider whether a bias of *any* kind exists.


```{r echo= F}
sheets.list[[19]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```








## From hands to tails: Tail probabilities

Consider this: What is more likely: to get exactly 14 heads, or at least 14 heads?  That is, to get exactly 14, or 14 or 15 or 16 or 17 or 18.

If I am concerned that a coin is not fair I am probably not concerned that it produces an exact number of heads for a given number of flips that wouldn't be a rigged coin, but straight up magic!  What I'd be concerned with is that it produces an unusual number of heads so I won't be interested in exactly 14, but 14 or more

## From hands to tails: Tail probabilities

 So, moving forward, let's consider what the probability of getting more than 14 right-handed toads.  In statistical terms, what we are now talking about here is a **"tail probability"**.

We've already done some of these calculations so we'll fill in 15 righties and 16 righties.

When we add up probabilities we get about 0.015.  This is our  "tail probability."  We'll explain what its the tail of later.
 
 
```{r echo= F}
sheets.list[[20]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```

## Quiz: tail probabilities


```{r q20}
question("What is the probability of getting 14 or more right handed toads if the null is true?.  Eyeball the answer",
answer("0.001"),
answer("0.01"),
answer("0.015",correct = TRUE),
answer("0.1"))
```



## Moving forward: tail probabilities

The answer is 0.015, or on the order of magnitude of 1 in 100 (1 in 105 to be exact).


```{r echo= F}
sheets.list[[21]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```

Note that due to rounding error the numbers might end up touch off.


## Moving forward: tail probabilities

Getting lots of heads is the converse of getting lots of tails and depends on your coin flipping protocol.  So getting 14 or more tails is just as unusual as 14 or more tails.  (Or, equivalently, 4 or fewer heads; Again, this is all assuming the null is true - tired of me saying that yet?)


```{r echo= F}
sheets.list[[22]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```






## Moving forward: tail probabilities

We can add up all of these numbers in the "tail.prob" column and see that they are the same as for 14 or more right-handed toads.

```{r echo= F}
sheets.list[[23]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```








## Fill in the rest of the probabilities

* We can fill in the rest of the probabilities.  
* We now have created a table that outlines all possible outcomes of the experiment.

```{r echo= F}
sheets.list[[24]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive"))
```

## Summing up probabilities

```{r q24}
question("What does the prob.X column sum to?",
         answer("0.5"),
         answer("1",
                correct = TRUE,
                message = "We have enumerated all the possibilities, so they should sum up to 1.0"),
         answer("2",
                message = "We're working with probabilities so they always add up too..."),
         answer("100",
                message = "This would be true if we were working with %s"))
```




## Add up each tail

We now add up both the "tails" we were looking at, (14 or more heads, or 4 or fewer).

```{r echo= F}
sheets.list[[25]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```






## Total of both tails

We've finally arrived at the number we're interested in: the total of both of the tails.  0.015 + 0.015 =  0.031 (a bit off due to rounding).

```{r echo= F}
sheets.list[[26]]%>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed","responsive")) 
```

But why exactly were we doing this?

```{r q24b}
question("What is this number 0.031",
         answer("A number, 0.031",
                message = "Well, technically yes..."),
         answer("I have no #%$@#% idea",
         message = "Sorry.  I haven't really said where this was all headed."),
         
         answer("A probability",
                message = "Yes, but be more specific"),
         answer("A P-value.",
                correct = TRUE,
                message = "Yes."),
         answer("A Bayesian posterior probability",
                message = "Definitely not!"))
```


## What was our hypothesis, anyway?

This draft of the tutorial has focused on the math behind hypothesis testing, and focused on the logic of the math, not the logic of the test.  In what follows I'll lay out some notes about how a "Null hypothesis significance test" works.

Our **null hypothesis (Ho)** was that toads really don't have a dominant paw and they are just as likely to use their right paw as their left paw when they complete a task, or that just as many toads are going to be right-pawed as left-pawed.  This is a very precise hypothesis.

Our **alternative hypothesis (Ha)** is that toads do have a dominant paw: the population is either biased right pawed or left pawed, perhaps due to some genetically determined neurological factor.  

The alternative hypothesis is pretty vague, though.  Its basically just "anything but the null."  

When we sample frogs even if Ho was indeed true, we are very unlikely to get exactly 50:50 right:left.  The question is, then, what makes more sense: to look at our data of 14 out of 18 right-handed toads and conclude "this data came from a population where toads are actually just as likely to be right handed as left pawed," or does it make more sense to say "this data came from a population where toads are not just as likely to be right as left pawed."

## A typical statistical workflow

When you do frequent statistics the workflow is typically

* collect data
* define a statistical model
* calculate an appropriate test statistic
* compare your test statistic to a sampling distribution which is based on
  + the data
  + a probability distribution
  + the null hypothesis
* calculate the probability of getting your test statistic -- or a test statistic more extreme -- assuming the null hypothesis is true
* Decide how you now feel about the Null hypothesis
  + This could lead you to outright reject the null
  + Or you can just say that you feel the null is likely not true
 

## The binomial test statistics

When you do a t-test, the test statistics is the t-statistics.  When you use a contingency table, its often a Chi-square value.  For ANOVA, its the F-statistic.

For binomial data, the test statistics is just the observed number "Successes."  So our test stat is 14 frogs.

Now we ask, "how likely is this test statistic (or an even more extreme one) if the null hypothesis was true?"

## The binomial sampling distribution

Our long, detailed series of calculations was all about creating a sampling distribution.  By filling out the table, we calculated all possible alternative outcomes that could've happened if the experiment was done exactly the same way again (or we looked across many parallel universes...).

So, a sampling distribution is a **probability distribution** that tells you the probability of other outcomes for an experiment **if** the null hypothesis was true.

## Comparing the test statistic to the sampling distribution

We can determine how likely our test statistic (14) is, and how likely its converse (4) is.  We can also calculate how likely it is to get a result even more extreme - that is, even more unlikely to occur if the null was true.  

This is our summing up of the tail probabilities.  We add up all the values from 14 to 18, and from 4 down to 0.  This is the total probability, if the null was true, that we'd observe the sampling statistic or something more extreme.

## The P-value

This probability - the sum of the tails of our sampling distribution -- is the P-value.  So, a P-value is the probability,if the null hypothesis was true, of obtaining the data we did (the test statistic) or data even more extreme.

This is a two-tailed p-value since added up both the tail starting with our observed test statistic (14) and its converse (4).

## Interpreting the P-value

What does this mean?  A simple way to look at a p-value is this: if you lived in a world where the null hypothesis was known to be true, the p-value is an index of how surprised you'd be to see the data observed in the experiment.  

What if the experiment had yielded 11 right-handed frogs?  The majority would still be righties, but the probably of getting 11 or more, or 7 or fewer, is fairly high (~0.48).  If someone should you data with 11 right handed frogs and you knew you lived in a world where frog where 50:50 right:left, you'd probably not be impressed.  "Meh, this could easily happen due to chance."  But 14 frogs, that's kind of unusual, if the null was true.

## Is this really how it works?

This logic is probably awkward at best, and perhaps confusing at worst.  But this is actually how the logic of all the stats most people do works.  You take data that was observed, than you transport yourself into a world where the null hypothesis is true and ask "how unusual is this data?"  More over, to make the math work while in null land you not only think about the data you got (say, 14 right pawed frogs) but also data you didn't get (15 or 16 or 17 or 18 right-pawed frogs) and data that is the converse of what you got (4 or 3 or 2 or 1 *left*-pawed frogs).  Based on how unlikely your data and these other theoretical and more extreme versions of the data are, you transport yourself back from null-land and pass judgement on the null hypothesis.  


## Direct binomial test in Excel

In this section, which currently exists in an alternate universe, I will show how to do a binomial hypothesis test directly in excel

## Looking ahead: Direct binomial test in R

### This tidbit is optional

We can do a binomial test directly in R using the **binom.test()** function.

As is convention x = 14, the number of events or successes (right-handed toads) and n = 18, the number of trials.  "p = 0.5" represents the null hypothesis.

If you poke around the output you'll see the p-value listed.

```{r binomtest , exercise=TRUE}
binom.test(x=14, n=18, p = 0.5)
```

R provides some additional information, beyond what we've talked about.  One thing is the "95 percent confidence interval".  This is listed as 0.5236 and 0.9359.  This confidence interval brackets the observed probability of success, 0.778.  It represents other plausible values for the proportion of right-handed toads in the population, given that we have a sample size of only 18.  Note that it doesn't contain the null value of 0.05.

## Looking ahead: logistic regression

### This tidbit is optional

A modern extension of binomial tests is **logistic regression.**  Logistic regression is a type of **generalized linear model**, or **glm** for short.  We can implement a  logistic regression version of our binomial test on our data using the **glm()** function in R.  There are several types of **glm**s, so we need to tell R "family = 'binomial'" so it knows that we have binomial data.

The output from a glm is much more complicated.  Can you spot the p-value in the mix?  Its actually less than 0.031, the value from the binomial test, but close.

```{r}
#make the data
hand <- c(rep("L",4),rep("R",14))

#make into a dataframe
dat <- data.frame(hand)

#run logistic regression using glm() function
hand.logit <- glm(hand ~ 1, data = dat, family = "binomial")

#look at output
summary(hand.logit)
```



